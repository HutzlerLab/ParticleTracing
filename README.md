# Particle Tracing

This repository contains all code allowing for particle tracing.  Original code design by Cal Miller (found [here](https://github.com/cal-miller-harvard/DSMC_Simulations "here")).

## Usage

The `ParticleTracing.jl` file provides the `Tracing` module to create a new particle tracing simulation.  To add the module to a current project, use the following code.

```julia
include("ParticleTracing.jl")
using .Tracing
```

The current version allows for simple simulation manipulation by running the `runParticleTracing()` function.  A list of parameters (both required and optional can be found below).

|  Name | Description  | Required  | Default Value  |
| :------------: | :------------: | :------------: | :------------: |
| `geom`  | The path of the file generated by SPARTA containing a list of surfaces  |  **Yes** | N/A  |
|  `flow` | The file generated by SPARTA containing a dump of flow properties at each grid point  | **Yes**  | N/A  |
| `n`  | The number of particles to simulate  | No | 10000  |
| `z`  | Axial position at which to spawn particles (m)  | No  | 0.035  |
| `r`  | Radial position at which to spawn particles (m) | No  | 0.0  |
|  `vz` | Mean axial velocity at which to spawn particles (m/s)  | No  | 0.0  |
| `vr`  | Mean radial velocity at which to spawn particles (m/s) | No  | 0.0  |
|  `T` | Temperature at which to spawn particles (K)  | No  | 0.0  |
| `m`  | Mass of buffer gas atoms (AMU)  | No  | 4.0  |
| `M`  | Mass of particles (AMU)  | No  | 191.0  |
| `sigma`  | Collision cross section between buffer gas and particlee (m^2)  | No  | 130E-20  |
|  `omega` | Radial trap frequency (rad/s); sqrt(v/m) for a harmonic trap of V(x,y,z) = v*(x^2+y^2) | No  | 0.0  |
| `zmin`  | Minimum axial position of harmonic trap (m)  | No  | -Inf  |
| `zmax`  | Maximum axial position of harmonic trap (m)  | No  | Inf  |
| `pflip`  | Probability that collision flips spin  | No  | 0.0  |
| `saveall` | Saves all particles if nonzero or just those that leave the cell if 0   | No  | 0  |
| `stats`  | Filename to save average properties of trajectories  | No  | nothing  |
| `exitstats`  | Filename to save average properties of trajectories where the particle hits the simulation boundary  | No  | nothing  |
| `particlesoutput` | Filename to save the properties of each particle | No | `stdout` |

## Example

Provided are two example files for the `geom` and `flow` parameters.  A working example can be seen in `test.jl` or as below.

```julia
include("ParticleTracing.jl")
using .Tracing

Tracing.runParticleTracing("cell.surfs", "flow.DAT", stats="stats.csv")
```
